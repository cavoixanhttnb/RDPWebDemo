{"version":3,"file":"linear-scale.js","sources":["linear-scale.js"],"sourcesContent":["import { geometry as geo, drawing } from '@progress/kendo-drawing';\nimport { setDefaultOptions, deepExtend, defined } from '../../common';\nimport { BLACK } from '../../common/constants';\nimport { NumericAxis } from '../../core';\nimport { DEFAULT_LINE_WIDTH, INSIDE } from '../constants';\nimport { autoMajorUnit } from '../../core';\nimport { buildLabelElement, getRange } from '../utils';\n\nconst { Path, Group } = drawing;\nconst Point = geo.Point;\n\nfunction renderAxisTick(tickRenderOptions, tickOptions) {\n    const { position, tickX, tickY } = tickRenderOptions;\n    let start, end;\n\n    if (tickRenderOptions.vertical) {\n        start = new Point(tickX, position);\n        end = new Point(tickX + tickOptions.size, position);\n    } else {\n        start = new Point(position, tickY);\n        end = new Point(position, tickY + tickOptions.size);\n    }\n\n    const tickPath = new Path({\n        stroke: {\n            color: tickOptions.color,\n            width: tickOptions.width\n        }\n    }).moveTo(start).lineTo(end);\n\n    return tickPath;\n}\n\nfunction renderTicks(tickGroup, tickPositions, tickRenderOptions, tickOptions) {\n    const count = tickPositions.length;\n\n    if (tickOptions.visible) {\n        const { mirror, lineBox } = tickRenderOptions;\n        for (let i = tickOptions.skip; i < count; i += tickOptions.step) {\n            if (i % tickOptions.skipUnit === 0) {\n                continue;\n            }\n\n            tickRenderOptions.tickX = mirror ? lineBox.x2 : lineBox.x2 - tickOptions.size;\n            tickRenderOptions.tickY = mirror ? lineBox.y1 - tickOptions.size : lineBox.y1;\n            tickRenderOptions.position = tickPositions[i];\n\n            tickGroup.append(renderAxisTick(tickRenderOptions, tickOptions));\n        }\n    }\n}\n\nclass LinearScale extends NumericAxis {\n    constructor(options, service) {\n        const scaleOptions = options || {};\n        if (!defined(scaleOptions.reverse) && scaleOptions.vertical === false && (service || {}).rtl) {\n            scaleOptions.reverse = true;\n        }\n\n        super(0, 1, scaleOptions, service);\n\n        this.options.minorUnit = this.options.minorUnit || this.options.majorUnit / 10;\n    }\n\n    initUserOptions(options) {\n        let scaleOptions = deepExtend({}, this.options, options);\n        scaleOptions = deepExtend({}, scaleOptions , { labels: { mirror: scaleOptions.mirror } });\n        scaleOptions.majorUnit = scaleOptions.majorUnit || autoMajorUnit(scaleOptions.min, scaleOptions.max);\n\n        return scaleOptions;\n    }\n\n    initFields() {\n    }\n\n    render() {\n        const elements = this.elements = new Group();\n        const labels = this.renderLabels();\n        const scaleLine = this.renderLine();\n        const scaleTicks = this.renderTicks();\n        const ranges = this.renderRanges();\n\n        elements.append(scaleLine, labels, scaleTicks, ranges);\n\n        return elements;\n    }\n\n    renderRanges() {\n        const options = this.options;\n        const { min, max, vertical, labels: { mirror } } = options;\n        const ranges = options.ranges || [];\n        const elements = new Group();\n        const count = ranges.length;\n        const rangeSize = options.rangeSize || options.minorTicks.size / 2;\n\n        for (let i = 0; i < count; i++) {\n            const range = getRange(ranges[i], min, max);\n            const slot = this.getSlot(range.from, range.to);\n            const slotX = vertical ? this.lineBox() : slot;\n            const slotY = vertical ? slot : this.lineBox();\n            if (vertical) {\n                slotX.x1 -= rangeSize * (mirror ? -1 : 1);\n            } else {\n                slotY.y2 += rangeSize * (mirror ? -1 : 1);\n            }\n\n            elements.append(Path.fromRect(new geo.Rect([ slotX.x1, slotY.y1 ], [ slotX.x2 - slotX.x1, slotY.y2 - slotY.y1 ]), {\n                fill: { color: range.color, opacity: range.opacity },\n                stroke: { }\n            }));\n        }\n\n        return elements;\n    }\n\n    renderLabels() {\n        const { labels, options } = this;\n        const elements = new Group();\n\n        for (let i = 0; i < labels.length; i++) {\n            elements.append(buildLabelElement(labels[i], options.labels));\n        }\n\n        return elements;\n    }\n\n    renderLine() {\n        const line = this.options.line;\n        const lineBox = this.lineBox();\n        const elements = new Group();\n\n        if (line.width > 0 && line.visible) {\n            const linePath = new Path({\n                stroke: {\n                    color: line.color,\n                    dashType: line.dashType,\n                    width: line.width\n                }\n            });\n\n            linePath.moveTo(lineBox.x1, lineBox.y1).lineTo(lineBox.x2, lineBox.y2);\n            elements.append(linePath);\n        }\n\n        return elements;\n    }\n\n    renderTicks() {\n        const ticks = new Group();\n        const options = this.options;\n        const majorUnit = options.majorTicks.visible ? options.majorUnit : 0;\n        const tickRenderOptions = {\n            vertical: options.vertical,\n            mirror: options.labels.mirror,\n            lineBox: this.lineBox()\n        };\n\n        renderTicks(ticks, this.getMajorTickPositions(), tickRenderOptions, options.majorTicks);\n        renderTicks(ticks, this.getMinorTickPositions(), tickRenderOptions, deepExtend({}, {\n            skipUnit: majorUnit / options.minorUnit\n        }, options.minorTicks));\n\n        return ticks;\n    }\n}\n\nsetDefaultOptions(LinearScale, {\n    min: 0,\n    max: 50,\n\n    majorTicks: {\n        size: 15,\n        align: INSIDE,\n        color: BLACK,\n        width: DEFAULT_LINE_WIDTH,\n        visible: true\n    },\n\n    minorTicks: {\n        size: 10,\n        align: INSIDE,\n        color: BLACK,\n        width: DEFAULT_LINE_WIDTH,\n        visible: true\n    },\n\n    line: {\n        width: DEFAULT_LINE_WIDTH\n    },\n\n    labels: {\n        position: INSIDE,\n        padding: 2\n    },\n    mirror: false,\n    _alignLines: false\n});\n\nexport default LinearScale;"],"names":["const","let","super","this"],"mappings":"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"}