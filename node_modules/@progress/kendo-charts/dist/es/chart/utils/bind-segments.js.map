{"version":3,"file":"bind-segments.js","sources":["bind-segments.js"],"sourcesContent":["import { isNumber, isString } from '../../common';\nimport SeriesBinder from '../series-binder';\nimport segmentVisible from './segment-visible';\n\nexport default function bindSegments(series) {\n    const data = series.data;\n    const points = [];\n    let sum = 0;\n    let count = 0;\n\n    for (let idx = 0; idx < data.length; idx++) {\n        const pointData = SeriesBinder.current.bindPoint(series, idx);\n        let value = pointData.valueFields.value;\n\n\n        if (isString(value)) {\n            value = parseFloat(value);\n        }\n\n        if (isNumber(value)) {\n            pointData.visible = segmentVisible(series, pointData.fields, idx) !== false;\n\n            pointData.value = Math.abs(value);\n            points.push(pointData);\n\n            if (pointData.visible) {\n                sum += pointData.value;\n            }\n\n            if (value !== 0) {\n                count++;\n            }\n        } else {\n            points.push(null);\n        }\n    }\n\n    return {\n        total: sum,\n        points: points,\n        count: count\n    };\n}"],"names":["const","let"],"mappings":"AAAA,SAAS,QAAQ,EAAE,QAAQ,QAAQ,cAAc,CAAC;AAClD,OAAO,YAAY,MAAM,kBAAkB,CAAC;AAC5C,OAAO,cAAc,MAAM,mBAAmB,CAAC;;AAE/C,eAAe,SAAS,YAAY,CAAC,MAAM,EAAE;IACzCA,GAAK,CAAC,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC;IACzBA,GAAK,CAAC,MAAM,GAAG,EAAE,CAAC;IAClBC,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC;IACZA,GAAG,CAAC,KAAK,GAAG,CAAC,CAAC;;IAEd,KAAKA,GAAG,CAAC,GAAG,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,EAAE;QACxCD,GAAK,CAAC,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;QAC9DC,GAAG,CAAC,KAAK,GAAG,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC;;;QAGxC,IAAI,QAAQ,CAAC,KAAK,CAAC,EAAE;YACjB,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC;SAC7B;;QAED,IAAI,QAAQ,CAAC,KAAK,CAAC,EAAE;YACjB,SAAS,CAAC,OAAO,GAAG,cAAc,CAAC,MAAM,EAAE,SAAS,CAAC,MAAM,EAAE,GAAG,CAAC,KAAK,KAAK,CAAC;;YAE5E,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YAClC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;;YAEvB,IAAI,SAAS,CAAC,OAAO,EAAE;gBACnB,GAAG,IAAI,SAAS,CAAC,KAAK,CAAC;aAC1B;;YAED,IAAI,KAAK,KAAK,CAAC,EAAE;gBACb,KAAK,EAAE,CAAC;aACX;SACJ,MAAM;YACH,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACrB;KACJ;;IAED,OAAO;QACH,KAAK,EAAE,GAAG;QACV,MAAM,EAAE,MAAM;QACd,KAAK,EAAE,KAAK;KACf,CAAC;"}