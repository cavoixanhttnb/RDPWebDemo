{"version":3,"file":"range-area-point.js","sources":["range-area-point.js"],"sourcesContent":["import { drawing as draw } from '@progress/kendo-drawing';\n\nimport { ChartElement, Point } from '../../core';\nimport RangeLinePoint from './range-line-point';\nimport PointEventsMixin from '../mixins/point-events-mixin';\nimport NoteMixin from '../mixins/note-mixin';\n\nimport { LINE_MARKER_SIZE, FADEIN, INITIAL_ANIMATION_DURATION, TOOLTIP_OFFSET, ABOVE, BELOW } from '../constants';\nimport { WHITE, CIRCLE, HIGHLIGHT_ZINDEX, LEFT, RIGHT, BOTTOM, CENTER } from '../../common/constants';\nimport { deepExtend, valueOrDefault, getSpacing } from '../../common';\n\nconst AUTO = 'auto';\nconst DEFAULT_FROM_FORMAT = '{0}';\nconst DEFAULT_TO_FORMAT = '{1}';\n\nclass RangeAreaPoint extends ChartElement {\n    constructor(value, options) {\n        super();\n\n        this.value = value;\n        this.options = options;\n        this.aboveAxis = valueOrDefault(this.options.aboveAxis, true);\n        this.tooltipTracking = true;\n        this.initLabelsFormat();\n    }\n\n    render() {\n        if (this._rendered) {\n            return;\n        }\n\n        this._rendered = true;\n\n        const { markers, labels } = this.options;\n        const value = this.value;\n\n        const fromPoint = this.fromPoint = new RangeLinePoint(value, deepExtend({}, this.options, {\n            labels: labels.from,\n            markers: markers.from\n        }));\n\n        const toPoint = this.toPoint = new RangeLinePoint(value, deepExtend({}, this.options, {\n            labels: labels.to,\n            markers: markers.to\n        }));\n\n        this.copyFields(fromPoint);\n        this.copyFields(toPoint);\n\n        this.append(fromPoint);\n        this.append(toPoint);\n    }\n\n    reflow(targetBox) {\n        this.render();\n\n        const { from: fromBox, to: toBox } = targetBox;\n\n        this.positionLabels(fromBox, toBox);\n\n        this.fromPoint.reflow(fromBox);\n        this.toPoint.reflow(toBox);\n\n        this.box = this.fromPoint.markerBox().clone().wrap(this.toPoint.markerBox());\n    }\n\n    createHighlight() {\n        const group = new draw.Group();\n        group.append(this.fromPoint.createHighlight());\n        group.append(this.toPoint.createHighlight());\n\n        return group;\n    }\n\n    highlightVisual() {\n        return this.visual;\n    }\n\n    highlightVisualArgs() {\n        return {\n            options: this.options,\n            from: this.fromPoint.highlightVisualArgs(),\n            to: this.toPoint.highlightVisualArgs()\n        };\n    }\n\n    tooltipAnchor() {\n        const clipBox = this.owner.pane.clipBox();\n        const showTooltip = !clipBox || clipBox.overlaps(this.box);\n\n        if (showTooltip) {\n            const box = this.box;\n            const center = box.center();\n            const horizontalAlign = LEFT;\n            let x, y, verticalAlign;\n\n            if (this.options.vertical) {\n                x = center.x;\n                y = box.y1 - TOOLTIP_OFFSET;\n                verticalAlign = BOTTOM;\n            } else {\n                x = box.x2 + TOOLTIP_OFFSET;\n                y = center.y;\n                verticalAlign = CENTER;\n            }\n\n            return {\n                point: new Point(x, y),\n                align: {\n                    horizontal: horizontalAlign,\n                    vertical: verticalAlign\n                }\n            };\n        }\n    }\n\n    formatValue(format) {\n        return this.owner.formatPointValue(this, format);\n    }\n\n    overlapsBox(box) {\n        return this.box.overlaps(box);\n    }\n\n    unclipElements() {\n        this.fromPoint.unclipElements();\n        this.toPoint.unclipElements();\n    }\n\n    initLabelsFormat() {\n        const labels = this.options.labels;\n        if (!labels.format) {\n            if (!labels.from || !labels.from.format) {\n                labels.from = Object.assign({}, labels.from, {\n                    format: DEFAULT_FROM_FORMAT\n                });\n            }\n\n            if (!labels.to || !labels.to.format) {\n                labels.to = Object.assign({}, labels.to, {\n                    format: DEFAULT_TO_FORMAT\n                });\n            }\n        }\n    }\n\n    positionLabels(fromBox, toBox) {\n        const { labels, vertical } = this.options;\n\n        if (labels.position === AUTO) {\n            let fromLabelPosition, toLabelPosition;\n            if (vertical) {\n                if (toBox.y1 <= fromBox.y1) {\n                    toLabelPosition = ABOVE;\n                    fromLabelPosition = BELOW;\n                } else {\n                    toLabelPosition = BELOW;\n                    fromLabelPosition = ABOVE;\n                }\n            } else {\n                if (toBox.x1 <= fromBox.x1) {\n                    toLabelPosition = LEFT;\n                    fromLabelPosition = RIGHT;\n                } else {\n                    toLabelPosition = RIGHT;\n                    fromLabelPosition = LEFT;\n                }\n            }\n\n            if (!labels.from || !labels.from.position) {\n                this.fromPoint.options.labels.position = fromLabelPosition;\n            }\n\n            if (!labels.to || !labels.to.position) {\n                this.toPoint.options.labels.position = toLabelPosition;\n            }\n        }\n    }\n\n    copyFields(point) {\n        point.dataItem = this.dataItem;\n        point.category = this.category;\n        point.series = this.series;\n        point.color = this.color;\n        point.owner = this.owner;\n    }\n}\n\ndeepExtend(RangeAreaPoint.prototype, PointEventsMixin);\ndeepExtend(RangeAreaPoint.prototype, NoteMixin);\n\nRangeAreaPoint.prototype.defaults = {\n    markers: {\n        visible: false,\n        background: WHITE,\n        size: LINE_MARKER_SIZE,\n        type: CIRCLE,\n        border: {\n            width: 2\n        },\n        opacity: 1\n    },\n    labels: {\n        visible: false,\n        margin: getSpacing(3),\n        padding: getSpacing(4),\n        animation: {\n            type: FADEIN,\n            delay: INITIAL_ANIMATION_DURATION\n        },\n        position: AUTO\n    },\n    notes: {\n        label: {}\n    },\n    highlight: {\n        markers: {\n            border: {\n                color: WHITE,\n                width: 2\n            }\n        },\n        zIndex: HIGHLIGHT_ZINDEX\n    },\n    tooltip: {\n        format: '{0} - {1}'\n    }\n};\n\nexport default RangeAreaPoint;\n"],"names":["const","super","let"],"mappings":"AAAA,SAAS,OAAO,IAAI,IAAI,QAAQ,yBAAyB,CAAC;;AAE1D,SAAS,YAAY,EAAE,KAAK,QAAQ,YAAY,CAAC;AACjD,OAAO,cAAc,MAAM,oBAAoB,CAAC;AAChD,OAAO,gBAAgB,MAAM,8BAA8B,CAAC;AAC5D,OAAO,SAAS,MAAM,sBAAsB,CAAC;;AAE7C,SAAS,gBAAgB,EAAE,MAAM,EAAE,0BAA0B,EAAE,cAAc,EAAE,KAAK,EAAE,KAAK,QAAQ,cAAc,CAAC;AAClH,SAAS,KAAK,EAAE,MAAM,EAAE,gBAAgB,EAAE,IAAI,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,QAAQ,wBAAwB,CAAC;AACtG,SAAS,UAAU,EAAE,cAAc,EAAE,UAAU,QAAQ,cAAc,CAAC;;AAEtEA,GAAK,CAAC,IAAI,GAAG,MAAM,CAAC;AACpBA,GAAK,CAAC,mBAAmB,GAAG,KAAK,CAAC;AAClCA,GAAK,CAAC,iBAAiB,GAAG,KAAK,CAAC;;AAEhC,IAAM,cAAc,GAAqB;IAAC,AACtC,uBAAW,CAAC,KAAK,EAAE,OAAO,EAAE;QACxBC,YAAK,KAAA,CAAC,IAAA,CAAC,CAAC;;QAER,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,SAAS,GAAG,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QAC9D,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;QAC5B,IAAI,CAAC,gBAAgB,EAAE,CAAC;KAC3B;;;;0DAAA;;IAED,yBAAA,MAAM,mBAAA,GAAG;QACL,IAAI,IAAI,CAAC,SAAS,EAAE;YAChB,OAAO;SACV;;QAED,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;;QAEtB,AAAK,AAAoB,OAAA,GAAG,IAAI,CAAC,OAAO;QAAhC,IAAA,OAAO;QAAE,IAAA,MAAM,cAAjB,AAAS,AAAQ,AAAiB,AAAC;QACzCD,GAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;;QAEzBA,GAAK,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,IAAI,cAAc,CAAC,KAAK,EAAE,UAAU,CAAC,EAAE,EAAE,IAAI,CAAC,OAAO,EAAE;YACtF,MAAM,EAAE,MAAM,CAAC,IAAI;YACnB,OAAO,EAAE,OAAO,CAAC,IAAI;SACxB,CAAC,CAAC,CAAC;;QAEJA,GAAK,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,cAAc,CAAC,KAAK,EAAE,UAAU,CAAC,EAAE,EAAE,IAAI,CAAC,OAAO,EAAE;YAClF,MAAM,EAAE,MAAM,CAAC,EAAE;YACjB,OAAO,EAAE,OAAO,CAAC,EAAE;SACtB,CAAC,CAAC,CAAC;;QAEJ,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;QAC3B,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;;QAEzB,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;QACvB,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;KACxB,CAAA;;IAED,yBAAA,MAAM,mBAAA,CAAC,SAAS,EAAE;QACd,IAAI,CAAC,MAAM,EAAE,CAAC;;QAEd,AAAK,AAAS,IAAA,OAAO;QAAM,IAAA,KAAK,gBAA1B,AAAe,AAAW,AAAE,AAAY,AAAC;;QAE/C,IAAI,CAAC,cAAc,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;;QAEpC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAC/B,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;;QAE3B,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,EAAE,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,EAAE,CAAC,CAAC;KAChF,CAAA;;IAED,yBAAA,eAAe,4BAAA,GAAG;QACdA,GAAK,CAAC,KAAK,GAAG,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;QAC/B,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,eAAe,EAAE,CAAC,CAAC;QAC/C,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,eAAe,EAAE,CAAC,CAAC;;QAE7C,OAAO,KAAK,CAAC;KAChB,CAAA;;IAED,yBAAA,eAAe,4BAAA,GAAG;QACd,OAAO,IAAI,CAAC,MAAM,CAAC;KACtB,CAAA;;IAED,yBAAA,mBAAmB,gCAAA,GAAG;QAClB,OAAO;YACH,OAAO,EAAE,IAAI,CAAC,OAAO;YACrB,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,mBAAmB,EAAE;YAC1C,EAAE,EAAE,IAAI,CAAC,OAAO,CAAC,mBAAmB,EAAE;SACzC,CAAC;KACL,CAAA;;IAED,yBAAA,aAAa,0BAAA,GAAG;QACZA,GAAK,CAAC,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;QAC1CA,GAAK,CAAC,WAAW,GAAG,CAAC,OAAO,IAAI,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;;QAE3D,IAAI,WAAW,EAAE;YACbA,GAAK,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;YACrBA,GAAK,CAAC,MAAM,GAAG,GAAG,CAAC,MAAM,EAAE,CAAC;YAC5BA,GAAK,CAAC,eAAe,GAAG,IAAI,CAAC;YAC7BE,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,aAAa,CAAC;;YAExB,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE;gBACvB,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC;gBACb,CAAC,GAAG,GAAG,CAAC,EAAE,GAAG,cAAc,CAAC;gBAC5B,aAAa,GAAG,MAAM,CAAC;aAC1B,MAAM;gBACH,CAAC,GAAG,GAAG,CAAC,EAAE,GAAG,cAAc,CAAC;gBAC5B,CAAC,GAAG,MAAM,CAAC,CAAC,CAAC;gBACb,aAAa,GAAG,MAAM,CAAC;aAC1B;;YAED,OAAO;gBACH,KAAK,EAAE,IAAI,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC;gBACtB,KAAK,EAAE;oBACH,UAAU,EAAE,eAAe;oBAC3B,QAAQ,EAAE,aAAa;iBAC1B;aACJ,CAAC;SACL;KACJ,CAAA;;IAED,yBAAA,WAAW,wBAAA,CAAC,MAAM,EAAE;QAChB,OAAO,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;KACpD,CAAA;;IAED,yBAAA,WAAW,wBAAA,CAAC,GAAG,EAAE;QACb,OAAO,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;KACjC,CAAA;;IAED,yBAAA,cAAc,2BAAA,GAAG;QACb,IAAI,CAAC,SAAS,CAAC,cAAc,EAAE,CAAC;QAChC,IAAI,CAAC,OAAO,CAAC,cAAc,EAAE,CAAC;KACjC,CAAA;;IAED,yBAAA,gBAAgB,6BAAA,GAAG;QACfF,GAAK,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;QACnC,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE;YAChB,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE;gBACrC,MAAM,CAAC,IAAI,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,IAAI,EAAE;oBACzC,MAAM,EAAE,mBAAmB;iBAC9B,CAAC,CAAC;aACN;;YAED,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,MAAM,EAAE;gBACjC,MAAM,CAAC,EAAE,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,EAAE,EAAE;oBACrC,MAAM,EAAE,iBAAiB;iBAC5B,CAAC,CAAC;aACN;SACJ;KACJ,CAAA;;IAED,yBAAA,cAAc,2BAAA,CAAC,OAAO,EAAE,KAAK,EAAE;QAC3B,AAAK,AAAqB,OAAA,GAAG,IAAI,CAAC,OAAO;QAAjC,IAAA,MAAM;QAAE,IAAA,QAAQ,gBAAlB,AAAQ,AAAU,AAAiB,AAAC;;QAE1C,IAAI,MAAM,CAAC,QAAQ,KAAK,IAAI,EAAE;YAC1BE,GAAG,CAAC,iBAAiB,EAAE,eAAe,CAAC;YACvC,IAAI,QAAQ,EAAE;gBACV,IAAI,KAAK,CAAC,EAAE,IAAI,OAAO,CAAC,EAAE,EAAE;oBACxB,eAAe,GAAG,KAAK,CAAC;oBACxB,iBAAiB,GAAG,KAAK,CAAC;iBAC7B,MAAM;oBACH,eAAe,GAAG,KAAK,CAAC;oBACxB,iBAAiB,GAAG,KAAK,CAAC;iBAC7B;aACJ,MAAM;gBACH,IAAI,KAAK,CAAC,EAAE,IAAI,OAAO,CAAC,EAAE,EAAE;oBACxB,eAAe,GAAG,IAAI,CAAC;oBACvB,iBAAiB,GAAG,KAAK,CAAC;iBAC7B,MAAM;oBACH,eAAe,GAAG,KAAK,CAAC;oBACxB,iBAAiB,GAAG,IAAI,CAAC;iBAC5B;aACJ;;YAED,IAAI,CAAC,MAAM,CAAC,IAAI,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,QAAQ,EAAE;gBACvC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,GAAG,iBAAiB,CAAC;aAC9D;;YAED,IAAI,CAAC,MAAM,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,QAAQ,EAAE;gBACnC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,QAAQ,GAAG,eAAe,CAAC;aAC1D;SACJ;KACJ,CAAA;;IAED,yBAAA,UAAU,uBAAA,CAAC,KAAK,EAAE;QACd,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC/B,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;QAC/B,KAAK,CAAC,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;QAC3B,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACzB,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;KAC5B,CAAA,AACJ;;;EA3K4B,YA2K5B,GAAA;;AAED,UAAU,CAAC,cAAc,CAAC,SAAS,EAAE,gBAAgB,CAAC,CAAC;AACvD,UAAU,CAAC,cAAc,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;;AAEhD,cAAc,CAAC,SAAS,CAAC,QAAQ,GAAG;IAChC,OAAO,EAAE;QACL,OAAO,EAAE,KAAK;QACd,UAAU,EAAE,KAAK;QACjB,IAAI,EAAE,gBAAgB;QACtB,IAAI,EAAE,MAAM;QACZ,MAAM,EAAE;YACJ,KAAK,EAAE,CAAC;SACX;QACD,OAAO,EAAE,CAAC;KACb;IACD,MAAM,EAAE;QACJ,OAAO,EAAE,KAAK;QACd,MAAM,EAAE,UAAU,CAAC,CAAC,CAAC;QACrB,OAAO,EAAE,UAAU,CAAC,CAAC,CAAC;QACtB,SAAS,EAAE;YACP,IAAI,EAAE,MAAM;YACZ,KAAK,EAAE,0BAA0B;SACpC;QACD,QAAQ,EAAE,IAAI;KACjB;IACD,KAAK,EAAE;QACH,KAAK,EAAE,EAAE;KACZ;IACD,SAAS,EAAE;QACP,OAAO,EAAE;YACL,MAAM,EAAE;gBACJ,KAAK,EAAE,KAAK;gBACZ,KAAK,EAAE,CAAC;aACX;SACJ;QACD,MAAM,EAAE,gBAAgB;KAC3B;IACD,OAAO,EAAE;QACL,MAAM,EAAE,WAAW;KACtB;CACJ,CAAC;;AAEF,eAAe,cAAc,CAAC;"}